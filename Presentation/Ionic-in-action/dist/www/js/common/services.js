service_v="1.0.0";var serviceModule=angular.module("starter.services",[]);serviceModule.service("scopeService",function(){return{safeApply:function(e,o){var n=e.$root.$$phase;"$apply"==n||"$digest"==n?o&&"function"==typeof o&&o():o&&"function"==typeof o?e.$apply(o):e.$apply()}}}),serviceModule.service("uiKit",["$rootScope","$q","$ionicLoading",function(e,o,n){var r=0,t={blockUI:function(){r++,n.show({template:"加载中",noBackdrop:!1})},unblockUI:function(){r--,0>=r&&n.hide()}};return t}]),serviceModule.factory("httpProxy",["$http",function(e){var o={call:function(o,n,r,t){var i=[];i.$promise=null;var a="";if(a=o.indexOf("http")>=0?o:appConfig.apiServer+o,void 0==r&&(r="post"),r=r.toLowerCase(),"post"==r&&(i.$promise=e.post(a,n)),"get"===r){var c="?";a.indexOf("?")>=0&&(c="&");var u=[];for(var p in n){var s=p+"="+escape(n[p]);u.push(s)}c+=u.join("&"),"&"!==c&&"?"!==c||(c=""),i.$promise=e.get(a+c)}return"delete"===r&&(i.$promise=e["delete"](a,{params:n})),"put"===r&&(i.$promise=e.put(a,n)),"jsonp"===r&&(a+="?callback=JSON_CALLBACK",i.$promise=e.jsonp(a,{params:n})),null!=i.$promise&&(i.$promise.then(function(e){angular.extend(i,e.data)},function(e){401==e.status}),i.$promise.refresh=function(e){i.$promise.then(function(){call(action,e).$promise.then(function(e){angular.extend(i,e.data)})})}),i}};return o}]),serviceModule.factory("service",["httpProxy","uiKit",function(e,o){var n=0,r=!1,t={call:function(t,i,a){n++,r||(r=!0,o.blockUI());var c=e.call(t,i,a);return c.$promise["finally"](function(){n--,0>=n&&setTimeout(function(){0>=n&&(r=!1,o.unblockUI())},300)}),c},backgroundCall:function(o,n,r){return e.call(o,n,r)}};return t}]);